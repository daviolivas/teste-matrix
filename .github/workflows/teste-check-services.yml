name: teste trademate

on:
  workflow_dispatch:
  
jobs:
  # validade-voice:
  #   strategy:
  #     matrix:
  #       machine: ${{ fromJson(vars.machines) }}
  #   uses: daviolivas/teste-matrix-reusable/.github/workflows/matrix-reusable.yml@main
  #   with:
  #     machine_name: ${{ matrix.machine }}
  #   secrets: inherit

  getting-status:
    name: Getting Status
    strategy:
      matrix:
        machine: [ubuntu-24.04, ubuntu-22.04]
    runs-on: ${{ matrix.machine }}

    steps:
    - name: pegando status 
      id: getting-status
      run: |
        echo "esse Ã© o runner ${{ matrix.machine }}. Ola novo job" > output.txt

    - name: uploading o artefato
      uses: actions/upload-artifact@v4
      with:
        name: output-from-${{ matrix.machine }}
        path: output.txt



  check-status:
    name: Checking Status
    needs: getting-status
    runs-on: [ubuntu-24.04]

    steps:
    - name: Baixar todos os artefatos
      uses: actions/download-artifact@v4
      with:
        path: ./saidas

    - name:
      run: |
        echo "oi rs"

        echo "### Resumo das saidas dos jobs da matriz:"
          
        for file in ./saidas/output-from-*/output.txt; do
          echo "---"
          cat "$file"
        done
        echo "---"